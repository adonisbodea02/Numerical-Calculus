function Lx=LagrangeBary2(nodes, values, x)  %nodes: x1,...,xn  %values: f(x1), ..., f(xn)  %set of points: x  A=CoeffBary(nodes); %vector of coefficients  %we apply formula Barycentric (7) from course 2, page 9  Lx=x;  for j=1:length(x)    x_pos_node=find(nodes==x(j)); %return the position of the node equal to x(j)    if x_pos_node       Lx(j)=values(x_pos_node);    else      Lx(j)=sum(A.*values./(x(j)-nodes))/...        sum(A./(x(j)-nodes));    endif  endfor
endfunction  function A=CoeffBary(nodes)  A=nodes; %NaN(size(nodes))  for i=1:length(nodes)    A(i)=1/prod(nodes(i)-nodes(nodes!=nodes(i)));  endforendfunction    
